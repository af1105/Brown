(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4297cc86"],{2909:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("6b75");function a(e){if(Array.isArray(e))return Object(r["a"])(e)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630");function o(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var i=n("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return a(e)||o(e)||Object(i["a"])(e)||s()}},"56fc":function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));n("99af"),n("b0c0"),n("4de4"),n("d3b7"),n("d81d");var r=n("995a"),a={CHANNEL:"消息通道",PROTOCOL:"通讯协议",DATABASE:"数据存储"},o={MQTT:{name:"MQTT",type:"all",group:"CHANNEL",details:{resource:{name:"地址",value:function(e){return e.properties.url}},rule:[{name:"地址",value:function(e){return e.properties.url}},{name:"Topic",value:function(e){return e.properties.topic}}]}},TCP:{name:"TCP",type:"source",group:"PROTOCOL",details:{resource:{name:"监听地址",value:function(e){return"0.0.0.0:".concat(e.properties.port)}},rule:[{name:"监听地址",value:function(e){return"0.0.0.0:".concat(e.properties.port)}},{name:"响应内容",value:function(e){return e.properties.response?"".concat(e.properties.response):void 0}}]}},UDP:{name:"UDP",type:"source",group:"PROTOCOL",details:{resource:{name:"监听地址",value:function(e){return"0.0.0.0:".concat(e.properties.port)}},rule:[{name:"监听地址",value:function(e){return"0.0.0.0:".concat(e.properties.port)}},{name:"响应内容",value:function(e){return e.properties.response?"".concat(e.properties.response):void 0}}]}},SNMP:{name:"SNMP",type:"source",group:"PROTOCOL",details:{resource:{name:"地址",value:function(e){return"udp:".concat(e.properties.ip,"/").concat(e.properties.port)}},rule:[{name:"地址",value:function(e){return"udp:".concat(e.properties.ip,"/").concat(e.properties.port)}},{name:"读取点位",value:function(e){return e.properties.points?e.properties.points.length:void 0}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},KAFKA:{name:"Kafka",type:"all",group:"CHANNEL",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.url)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.url)}},{name:"Topic",value:function(e){return e.properties.topic}}]}},RABBITMQ:{name:"RabbitMQ",type:"all",group:"CHANNEL",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port)}},{name:"虚拟主机",value:function(e){return e.properties.virtualHost}},{name:"交换机",value:function(e){return e.properties.exchange}},{name:"队列",value:function(e){return e.properties.queue}}]}},ROCKETMQ:{name:"RocketMQ",type:"all",group:"CHANNEL",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.url)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.url)}},{name:"分组",value:function(e){return e.properties.group}},{name:"Topic",value:function(e){return e.properties.topic}}]}},ACTIVEMQ:{name:"ActiveMQ",type:"all",group:"CHANNEL",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.url)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.url)}},{name:function(e){return"queue"===e.properties.model?"Queue":"Topic"},value:function(e){return"queue"===e.properties.model?e.properties.queue:e.properties.topic}}]}},PULSAR:{name:"Pulsar",type:"all",group:"CHANNEL",details:{resource:{name:"地址",value:function(e){return e.properties.url}},rule:[{name:"地址",value:function(e){return e.properties.url}},{name:"Topic",value:function(e){return e.properties.topic}}]}},MYSQL:{name:"MySQL",type:"all",group:"DATABASE",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",value:function(e){return e.properties.sql}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},MARIADB:{name:"MariaDB",type:"all",group:"DATABASE",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",value:function(e){return e.properties.sql}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},POSTGRESQL:{name:"PostgreSQL",type:"all",group:"DATABASE",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",value:function(e){return e.properties.sql}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},TIMESCALEDB:{name:"TimescaleDB",type:"all",group:"DATABASE",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",value:function(e){return e.properties.sql}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},SQLSERVER:{name:"SQL Server",type:"all",group:"DATABASE",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",value:function(e){return e.properties.sql}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},TDENGINE:{name:"TDengine",type:"all",group:"DATABASE",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",value:function(e){return e.properties.sql}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},KINGBASE:{name:"KingbaseES",type:"all",group:"DATABASE",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",value:function(e){return e.properties.sql}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},DM8:{name:"DM8",type:"all",group:"DATABASE",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port)}},{name:"SQL模板",value:function(e){return e.properties.sql}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},HTTPCLIENT:{name:"HTTP Client",type:"all",group:"PROTOCOL",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.url)}},rule:[{name:"请求路径",value:function(e){return"".concat(e.properties.url).concat(e.properties.path)}},{name:"请求方式",value:function(e){return"".concat(e.properties.method)}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},HTTPSERVER:{name:"HTTP Server",type:"source",group:"PROTOCOL",details:{resource:{name:"监听地址",value:function(e){return"http://0.0.0.0:".concat(e.properties.port).concat(e.properties.path)}},rule:[{name:"监听地址",value:function(e){return"http://0.0.0.0:".concat(e.properties.port).concat(e.properties.path)}},{name:"响应内容",value:function(e){return e.properties.response?"".concat(e.properties.response):void 0}}]}},COAPCLIENT:{name:"CoAP Client",type:"all",group:"PROTOCOL",details:{resource:{name:"地址",value:function(e){return"coap://".concat(e.properties.ip,":").concat(e.properties.port)}},rule:[{name:"请求路径",value:function(e){return"coap://".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.path)}},{name:"请求方式",value:function(e){return"".concat(e.properties.method)}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},COAPSERVER:{name:"CoAP Server",type:"source",group:"PROTOCOL",details:{resource:{name:"监听地址",value:function(e){return"coap://0.0.0.0:".concat(e.properties.port,"/").concat(e.properties.path)}},rule:[{name:"监听地址",value:function(e){return"coap://0.0.0.0:".concat(e.properties.port,"/").concat(e.properties.path)}},{name:"响应内容",value:function(e){return e.properties.response?"".concat(e.properties.response):void 0}}]}},OPCUA:{name:"OPC UA",type:"all",group:"PROTOCOL",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port)}},rule:[{name:"地址",value:function(e){return"opc.tcp://".concat(e.properties.ip,":").concat(e.properties.port)}},{name:"读取点位",value:function(e){return e.properties.points?e.properties.points.length:void 0}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}},{name:"点位地址",value:function(e){return e.properties.address}},{name:"数据类型",value:function(e){return e.properties.dataType}},{name:"数据值",value:function(e){return e.properties.dataValue}}]}},MODBUSTCP:{name:"Modbus TCP",type:"source",group:"PROTOCOL",details:{resource:{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port)}},rule:[{name:"地址",value:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port)}},{name:"读取点位",value:function(e){return e.properties.points?e.properties.points.length:void 0}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},REDIS:{name:"Redis",type:"all",group:"DATABASE",details:{resource:{name:"地址",value:function(e){return"STANDALONE"===e.properties.mode?"".concat(e.properties.ip,":").concat(e.properties.port):"".concat(e.properties.nodes)}},rule:[{name:"地址",value:function(e){return"STANDALONE"===e.properties.mode?"".concat(e.properties.ip,":").concat(e.properties.port):"".concat(e.properties.nodes)}},{name:"执行命令",value:function(e){return"".concat(e.properties.command)}},{name:"启动延迟",value:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(r["b"][e.properties.initialDelayUnit]):void 0}},{name:"Cron表达式",value:function(e){return e.properties.cronExpression}}]}},FILE:{name:"File",type:"all",group:"DATABASE",details:{resource:{name:"文件位置",value:function(e){return"".concat(e.properties.path)}},rule:[{name:"文件路径",value:function(e){return"".concat(e.properties.path).concat(e.properties.file)}},{name:"监听延迟",value:function(e){return e.properties.delay?"".concat(e.properties.delay,"ms"):void 0}},{name:"内容模板",value:function(e){return e.properties.content?e.properties.content:void 0}}]}}};function i(){var e={};for(var t in o)e[t]=o[t].name;return e}var s=i();function c(e){var t=[];for(var n in a){var r=u(e,n);r&&0!==r.length&&t.push({group:a[n],list:r})}return t}function u(e,t){var n=[];for(var r in o){var a=o[r];if((!e||a.type===e||"all"===a.type)&&(!t||a.group===t)){var i={name:a.name,type:a.type,code:r};n.push(i)}}return n}var l=c(void 0),p={name:"",value:""};function d(e,t){if(!e||!e.resourceType)return"resource"===t?p:[p];var n=o[e.resourceType],r=n.details[t];return"resource"===t?f(r,e):r.map((function(t){return f(t,e)})).filter((function(e){return e.name&&e.value}))}function f(e,t){var n="string"===typeof e.name?e.name:e.name(t);if(!n)return p;var r="string"===typeof e.value?e.value:e.value(t);return r?{name:n,value:r}:p}},"995a":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r={MILLIS:"毫秒",SECONDS:"秒",MINUTES:"分钟",HOURS:"小时",DAYS:"天",WEEKS:"周",MONTHS:"月",YEARS:"年"};function a(){var e=[];for(var t in r)e.push({name:r[t],value:t});return e}var o=a()},b85c:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");var r=n("06c5");function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Object(r["a"])(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(c)throw i}}}}},dfd5:function(e,t,n){"use strict";var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"点位配置",width:850,closable:!1,maskClosable:!1,bodyStyle:{paddingTop:"15px"}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("template",{slot:"footer"},[t("a-button",{key:"back",on:{click:e.handleClose}},[e._v("关闭")]),t("a-button",{directives:[{name:"show",rawName:"v-show",value:!e.disableEdit,expression:"!disableEdit"}],key:"submit",attrs:{type:"primary"},on:{click:e.handleOk}},[e._v("保存")])],1),"OPCUA"===e.resourceType?t("opc-u-a-points-model",{ref:"PointModel",attrs:{"disable-edit":e.disableEdit}}):e._e(),"SNMP"===e.resourceType?t("snmp-points-model",{ref:"PointModel",attrs:{"disable-edit":e.disableEdit}}):e._e(),"MODBUSTCP"===e.resourceType?t("modbus-tcp-points-model",{ref:"PointModel",attrs:{"disable-edit":e.disableEdit}}):e._e()],2)},a=[],o=(n("b64b"),n("07ac"),function(){var e=this,t=e._self._c;return t("div",[t("a-row",{directives:[{name:"show",rawName:"v-show",value:!e.disableEdit,expression:"!disableEdit"}],staticStyle:{width:"100%","padding-bottom":"10px"}},[t("a-col",{attrs:{span:18}},[t("a-space",{attrs:{size:"small"}},[t("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.newItem}},[e._v("添加")]),t("a-upload",{attrs:{showUploadList:!1,beforeUpload:function(t){return e.checkFile(t,5,["xlsx"])},customRequest:e.customRequest},on:{change:e.handlerUpload}},[t("a-button",{attrs:{icon:"upload"}},[e._v("导入")])],1),t("a-button",{attrs:{icon:"download"},on:{click:e.download}},[e._v("导出")]),t("a-popconfirm",{attrs:{title:"删除选中点位？"},on:{confirm:e.removeBatch}},[t("a-button",{directives:[{name:"show",rawName:"v-show",value:e.selectedRowKeys.length>0,expression:"selectedRowKeys.length > 0"}],attrs:{type:"danger",icon:"delete"}},[e._v(" 删除选中("+e._s(e.selectedRowKeys.length)+") ")])],1)],1)],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[t("a-button",{attrs:{type:"link",icon:"download"},on:{click:function(t){return e.downloadFile("/template/opcua.xlsx","opcua.xlsx")}}},[e._v("下载模板 ")])],1)],1),t("a-table",{staticStyle:{border:"1px #e8e3e3 solid"},attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.loading,size:"middle","row-selection":e.disableEdit?null:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},scroll:{y:400}},scopedSlots:e._u([e._l(Object.keys(e.fieldMap),(function(n,r){return{key:n,fn:function(a,o){return[o.editable?t("a-input",{key:n,staticStyle:{margin:"-5px 0"},attrs:{value:a,placeholder:Object.values(e.fieldMap)[r]},on:{change:function(t){return e.handleChange(t.target.value,o.key,n)}}}):[e._v(e._s(a))]]}}})),{key:"index",fn:function(t,n,r){return[e._v(" "+e._s(r+1)+" ")]}},{key:"action",fn:function(n,r){return[r.editable?[r.isNew?t("span",[t("a",{on:{click:function(t){return e.saveRow(r)}}},[e._v("确定")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(r.key)}}},[t("a",[e._v("删除")])])],1):t("span",[t("a",{on:{click:function(t){return e.saveRow(r)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.cancel(r.key)}}},[e._v("取消")])],1)]:t("span",[t("a",{on:{click:function(t){return e.toggle(r.key)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(r.key)}}},[t("a",[e._v("删除")])])],1)]}}],null,!0)})],1)}),i=[],s=n("2909"),c=n("5530"),u=n("b85c"),l=(n("d3b7"),n("25f0"),n("4de4"),n("7db0"),n("159b"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("ca00")),p=n("0fea"),d={name:"OpcUAPointsModel",props:{disableEdit:{type:Boolean,default:!1}},data:function(){return{loading:!1,data:[],selectedRowKeys:[],fieldMap:{tag:"标签",address:"地址"},columns:[{title:"#",dataIndex:"index",width:"10%",scopedSlots:{customRender:"index"}},{title:"标签",dataIndex:"tag",key:"tag",width:"25%",scopedSlots:{customRender:"tag"}},{title:"地址",dataIndex:"address",key:"address",width:"45%",scopedSlots:{customRender:"address"}}]}},mounted:function(){this.disableEdit||this.columns.push({title:"操作",key:"action",scopedSlots:{customRender:"action"}})},methods:{checkFile:l["a"],downloadFile:l["b"],set:function(e){if(this.data=[],e){var t,n=1,r=Object(u["a"])(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;this.data.push({key:n++,tag:a.tag,address:a.address,editable:!1,isNew:!1})}}catch(o){r.e(o)}finally{r.f()}}},get:function(){var e,t=[],n=Object(u["a"])(this.data);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.isNew||t.push({tag:r.tag,address:r.address})}}catch(a){n.e(a)}finally{n.f()}return t},newItem:function(){var e=this.data.length;this.data.push({key:0===e?"1":(parseInt(this.data[e-1].key)+1).toString(),tag:"",address:"",editable:!0,isNew:!0})},remove:function(e){this.data=this.data.filter((function(t){return t.key!==e})),this.selectedRowKeys=this.selectedRowKeys.filter((function(t){return t!==e}))},removeBatch:function(){var e=this;this.data=this.data.filter((function(t){return-1===e.selectedRowKeys.indexOf(t.key)})),this.selectedRowKeys=[]},saveRow:function(e){this.loading=!0;var t=e.key,n=e.tag,r=e.address;if(!n||!r)return this.loading=!1,void this.$message.error("填写不完整");var a=this.data.find((function(e){return e.key===t}));a.editable=!1,a.isNew=!1,this.loading=!1},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(c["a"])({},t),t.editable=!t.editable},cancel:function(e){var t=this.data.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0},handleChange:function(e,t,n){var r=Object(s["a"])(this.data),a=r.find((function(e){return t===e.key}));a&&(a[n]=e,this.data=r)},handlerUpload:function(e){if("done"===e.file.status)if(200===e.file.response.code){var t,n=e.file.response.data,r=this.data.length,a=r?parseInt(this.data[r-1].key):0,o=Object(u["a"])(n);try{for(o.s();!(t=o.n()).done;){var i=t.value;i.key=(++a).toString(),i.editable=!1,i.isNew=!1,this.data.push(i)}}catch(s){o.e(s)}finally{o.f()}this.$message.success("已导入"+n.length+"个点位")}else this.$message.error("上传出错,".concat(e.file.response.message));else"error"===e.file.status&&this.$message.error("上传出错")},customRequest:function(e){var t=this,n=new FormData,r={};Object.keys(this.fieldMap).forEach((function(e){r[t.fieldMap[e]]=e})),n.append("file",e.file),n.append("field",JSON.stringify(r)),Object(p["f"])("/api/rule/points/import",n).then((function(t){e.onSuccess(t,e.file)}))},download:function(){Object(p["b"])("/api/rule/points/export",{data:this.get(),fieldMap:this.fieldMap,fileName:"opcua.xlsx"}).then((function(e){var t=new Blob([e]),n=document.createElement("a"),r=window.URL.createObjectURL(t);n.href=r,n.download=decodeURIComponent("opcua.xlsx"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}))},onSelectChange:function(e){this.selectedRowKeys=e}}},f=d,v=n("2877"),m=Object(v["a"])(f,o,i,!1,null,null,null),h=m.exports,y=function(){var e=this,t=e._self._c;return t("div",[t("a-row",{directives:[{name:"show",rawName:"v-show",value:!e.disableEdit,expression:"!disableEdit"}],staticStyle:{width:"100%","padding-bottom":"10px"}},[t("a-col",{attrs:{span:18}},[t("a-space",{attrs:{size:"small"}},[t("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.newItem}},[e._v("添加")]),t("a-upload",{attrs:{showUploadList:!1,beforeUpload:function(t){return e.checkFile(t,5,["xlsx"])},customRequest:e.customRequest},on:{change:e.handlerUpload}},[t("a-button",{attrs:{icon:"upload"}},[e._v("导入")])],1),t("a-button",{attrs:{icon:"download"},on:{click:e.download}},[e._v("导出")]),t("a-popconfirm",{attrs:{title:"删除选中点位？"},on:{confirm:e.removeBatch}},[t("a-button",{directives:[{name:"show",rawName:"v-show",value:e.selectedRowKeys.length>0,expression:"selectedRowKeys.length > 0"}],attrs:{type:"danger",icon:"delete"}},[e._v(" 删除选中("+e._s(e.selectedRowKeys.length)+") ")])],1)],1)],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[t("a-button",{attrs:{type:"link",icon:"download"},on:{click:function(t){return e.downloadFile("/template/snmp.xlsx","snmp.xlsx")}}},[e._v("下载模板")])],1)],1),t("a-table",{staticStyle:{border:"1px #e8e3e3 solid"},attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.loading,size:"middle","row-selection":e.disableEdit?null:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},scroll:{y:400}},scopedSlots:e._u([e._l(Object.keys(e.fieldMap),(function(n,r){return{key:n,fn:function(a,o){return[o.editable?t("a-input",{key:n,staticStyle:{margin:"-5px 0"},attrs:{value:a,placeholder:Object.values(e.fieldMap)[r]},on:{change:function(t){return e.handleChange(t.target.value,o.key,n)}}}):[e._v(e._s(a))]]}}})),{key:"index",fn:function(t,n,r){return[e._v(" "+e._s(r+1)+" ")]}},{key:"action",fn:function(n,r){return[r.editable?[r.isNew?t("span",[t("a",{on:{click:function(t){return e.saveRow(r)}}},[e._v("确定")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(r.key)}}},[t("a",[e._v("删除")])])],1):t("span",[t("a",{on:{click:function(t){return e.saveRow(r)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.cancel(r.key)}}},[e._v("取消")])],1)]:t("span",[t("a",{on:{click:function(t){return e.toggle(r.key)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(r.key)}}},[t("a",[e._v("删除")])])],1)]}}],null,!0)})],1)},b=[],g={name:"SnmpPointsModel",props:{disableEdit:{type:Boolean,default:!1}},data:function(){return{loading:!1,data:[],selectedRowKeys:[],fieldMap:{oid:"OID",type:"读取方式"},columns:[{title:"#",dataIndex:"index",width:"10%",scopedSlots:{customRender:"index"}},{title:"OID",dataIndex:"oid",key:"oid",width:"40%",scopedSlots:{customRender:"oid"}},{title:"读取方式(GET/WALK)",dataIndex:"type",key:"type",width:"30%",scopedSlots:{customRender:"type"}}]}},mounted:function(){this.disableEdit||this.columns.push({title:"操作",key:"action",scopedSlots:{customRender:"action"}})},methods:{checkFile:l["a"],downloadFile:l["b"],set:function(e){if(this.data=[],e){var t,n=1,r=Object(u["a"])(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;this.data.push({key:n++,oid:a.oid,type:a.type,editable:!1,isNew:!1})}}catch(o){r.e(o)}finally{r.f()}}},get:function(){var e,t=[],n=Object(u["a"])(this.data);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.isNew||t.push({oid:r.oid,type:r.type})}}catch(a){n.e(a)}finally{n.f()}return t},newItem:function(){var e=this.data.length;this.data.push({key:0===e?"1":(parseInt(this.data[e-1].key)+1).toString(),oid:"",type:"GET",editable:!0,isNew:!0})},remove:function(e){this.data=this.data.filter((function(t){return t.key!==e})),this.selectedRowKeys=this.selectedRowKeys.filter((function(t){return t!==e}))},removeBatch:function(){var e=this;this.data=this.data.filter((function(t){return-1===e.selectedRowKeys.indexOf(t.key)})),this.selectedRowKeys=[]},saveRow:function(e){this.loading=!0;var t=e.key,n=e.oid,r=e.type;if(!n||!r)return this.loading=!1,void this.$message.error("填写不完整");if("GET"!==r&&"WALK"!==r)return this.loading=!1,void this.$message.error("读取方式必须是GET或WALK");var a=this.data.find((function(e){return e.key===t}));a.editable=!1,a.isNew=!1,this.loading=!1},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(c["a"])({},t),t.editable=!t.editable},cancel:function(e){var t=this.data.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0},handleChange:function(e,t,n){var r=Object(s["a"])(this.data),a=r.find((function(e){return t===e.key}));a&&(a[n]=e,this.data=r)},handlerUpload:function(e){if("done"===e.file.status)if(200===e.file.response.code){var t,n=e.file.response.data,r=this.data.length,a=r?parseInt(this.data[r-1].key):0,o=Object(u["a"])(n);try{for(o.s();!(t=o.n()).done;){var i=t.value;i.key=(++a).toString(),i.editable=!1,i.isNew=!1,this.data.push(i)}}catch(s){o.e(s)}finally{o.f()}this.$message.success("已导入"+n.length+"个点位")}else this.$message.error("上传出错,".concat(e.file.response.message));else"error"===e.file.status&&this.$message.error("上传出错")},customRequest:function(e){var t=this,n=new FormData,r={};Object.keys(this.fieldMap).forEach((function(e){r[t.fieldMap[e]]=e})),n.append("file",e.file),n.append("field",JSON.stringify(r)),Object(p["f"])("/api/rule/points/import",n).then((function(t){e.onSuccess(t,e.file)}))},download:function(){Object(p["b"])("/api/rule/points/export",{data:this.get(),fieldMap:this.fieldMap,fileName:"snmp.xlsx"}).then((function(e){var t=new Blob([e]),n=document.createElement("a"),r=window.URL.createObjectURL(t);n.href=r,n.download=decodeURIComponent("snmp.xlsx"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}))},onSelectChange:function(e){this.selectedRowKeys=e}}},w=g,k=Object(v["a"])(w,y,b,!1,null,null,null),S=k.exports,R=function(){var e=this,t=e._self._c;return t("div",[t("a-row",{directives:[{name:"show",rawName:"v-show",value:!e.disableEdit,expression:"!disableEdit"}],staticStyle:{width:"100%","padding-bottom":"10px"}},[t("a-col",{attrs:{span:18}},[t("a-space",{attrs:{size:"small"}},[t("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.newItem}},[e._v("添加")]),t("a-upload",{attrs:{showUploadList:!1,beforeUpload:function(t){return e.checkFile(t,5,["xlsx"])},customRequest:e.customRequest},on:{change:e.handlerUpload}},[t("a-button",{attrs:{icon:"upload"}},[e._v("导入")])],1),t("a-button",{attrs:{icon:"download"},on:{click:e.download}},[e._v("导出")]),t("a-popconfirm",{attrs:{title:"删除选中点位？"},on:{confirm:e.removeBatch}},[t("a-button",{directives:[{name:"show",rawName:"v-show",value:e.selectedRowKeys.length>0,expression:"selectedRowKeys.length > 0"}],attrs:{type:"danger",icon:"delete"}},[e._v(" 删除选中("+e._s(e.selectedRowKeys.length)+") ")])],1)],1)],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[t("a-button",{attrs:{type:"link",icon:"download"},on:{click:function(t){return e.downloadFile("/template/modbustcp.xlsx","modbustcp.xlsx")}}},[e._v("下载模板")])],1)],1),t("a-table",{staticStyle:{border:"1px #e8e3e3 solid"},attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.loading,size:"middle","row-selection":e.disableEdit?null:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},scroll:{y:400}},scopedSlots:e._u([e._l(Object.keys(e.fieldMap),(function(n,r){return{key:n,fn:function(a,o){return[o.editable?t("a-input",{key:n,staticStyle:{margin:"-5px 0"},attrs:{value:a,placeholder:Object.values(e.fieldMap)[r]},on:{change:function(t){return e.handleChange(t.target.value,o.key,n)}}}):[e._v(e._s(a))]]}}})),{key:"index",fn:function(t,n,r){return[e._v(" "+e._s(r+1)+" ")]}},{key:"action",fn:function(n,r){return[r.editable?[r.isNew?t("span",[t("a",{on:{click:function(t){return e.saveRow(r)}}},[e._v("确定")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(r.key)}}},[t("a",[e._v("删除")])])],1):t("span",[t("a",{on:{click:function(t){return e.saveRow(r)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.cancel(r.key)}}},[e._v("取消")])],1)]:t("span",[t("a",{on:{click:function(t){return e.toggle(r.key)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(r.key)}}},[t("a",[e._v("删除")])])],1)]}}],null,!0)})],1)},O=[],x={name:"ModbusTcpPointsModel",props:{disableEdit:{type:Boolean,default:!1}},data:function(){return{loading:!1,data:[],selectedRowKeys:[],fieldMap:{tag:"标签",func:"功能",address:"地址",type:"数据类型"},columns:[{title:"#",dataIndex:"index",width:"10%",scopedSlots:{customRender:"index"}},{title:"标签",dataIndex:"tag",key:"tag",width:"20%",scopedSlots:{customRender:"tag"}},{title:"功能",dataIndex:"func",key:"func",width:"20%",scopedSlots:{customRender:"func"}},{title:"地址",dataIndex:"address",key:"address",width:"15%",scopedSlots:{customRender:"address"}},{title:"数据类型",dataIndex:"type",key:"type",width:"15%",scopedSlots:{customRender:"type"}}]}},mounted:function(){this.disableEdit||this.columns.push({title:"操作",key:"action",scopedSlots:{customRender:"action"}})},methods:{checkFile:l["a"],downloadFile:l["b"],set:function(e){if(this.data=[],e){var t,n=1,r=Object(u["a"])(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;this.data.push({key:n++,tag:a.tag,func:a.func,address:a.address,type:a.type,editable:!1,isNew:!1})}}catch(o){r.e(o)}finally{r.f()}}},get:function(){var e,t=[],n=Object(u["a"])(this.data);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.isNew||t.push({tag:r.tag,func:r.func,address:r.address,type:r.type})}}catch(a){n.e(a)}finally{n.f()}return t},newItem:function(){var e=this.data.length;this.data.push({key:0===e?"1":(parseInt(this.data[e-1].key)+1).toString(),tag:"",func:"holding-register",address:"1",type:"INT",editable:!0,isNew:!0})},remove:function(e){this.data=this.data.filter((function(t){return t.key!==e})),this.selectedRowKeys=this.selectedRowKeys.filter((function(t){return t!==e}))},removeBatch:function(){var e=this;this.data=this.data.filter((function(t){return-1===e.selectedRowKeys.indexOf(t.key)})),this.selectedRowKeys=[]},saveRow:function(e){this.loading=!0;var t=e.key,n=e.tag,r=e.func,a=e.address,o=e.type;if(!n||!r||!a||!o)return this.loading=!1,void this.$message.error("填写不完整");var i=this.data.find((function(e){return e.key===t}));i.editable=!1,i.isNew=!1,this.loading=!1},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(c["a"])({},t),t.editable=!t.editable},cancel:function(e){var t=this.data.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0},handleChange:function(e,t,n){var r=Object(s["a"])(this.data),a=r.find((function(e){return t===e.key}));a&&(a[n]=e,this.data=r)},handlerUpload:function(e){if("done"===e.file.status)if(200===e.file.response.code){var t,n=e.file.response.data,r=this.data.length,a=r?parseInt(this.data[r-1].key):0,o=Object(u["a"])(n);try{for(o.s();!(t=o.n()).done;){var i=t.value;i.key=(++a).toString(),i.editable=!1,i.isNew=!1,this.data.push(i)}}catch(s){o.e(s)}finally{o.f()}this.$message.success("已导入"+n.length+"个点位")}else this.$message.error("上传出错,".concat(e.file.response.message));else"error"===e.file.status&&this.$message.error("上传出错")},customRequest:function(e){var t=this,n=new FormData,r={};Object.keys(this.fieldMap).forEach((function(e){r[t.fieldMap[e]]=e})),n.append("file",e.file),n.append("field",JSON.stringify(r)),Object(p["f"])("/api/rule/points/import",n).then((function(t){e.onSuccess(t,e.file)}))},download:function(){Object(p["b"])("/api/rule/points/export",{data:this.get(),fieldMap:this.fieldMap,fileName:"modbustcp.xlsx"}).then((function(e){var t=new Blob([e]),n=document.createElement("a"),r=window.URL.createObjectURL(t);n.href=r,n.download=decodeURIComponent("modbustcp.xlsx"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}))},onSelectChange:function(e){this.selectedRowKeys=e}}},E=x,T=Object(v["a"])(E,R,O,!1,null,null,null),C=T.exports,D={name:"PointsConfigModel",components:{OpcUAPointsModel:h,SnmpPointsModel:S,ModbusTcpPointsModel:C},data:function(){return{visible:!1,resourceType:null,resourceMode:null,resourceIndex:-1,disableEdit:!1}},methods:{show:function(e,t){var n=this;this.resourceType=e,this.$nextTick((function(){n.$refs.PointModel.set(t)})),this.disableEdit=!0,this.visible=!0},config:function(e,t,n,r){var a=this;this.resourceType=e,this.resourceMode=t,this.resourceIndex=n,this.$nextTick((function(){a.$refs.PointModel.set(r)})),this.disableEdit=!1,this.visible=!0},handleOk:function(){this.$emit("update",this.resourceMode,this.resourceIndex,this.$refs.PointModel.get()),this.handleClose()},handleClose:function(){this.visible=!1,this.resourceType=null,this.resourceMode=null,this.resourceIndex=-1}}},N=D,_=Object(v["a"])(N,r,a,!1,null,"f3948db4",null);t["a"]=_.exports},f20e:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));n("b0c0");var r=[{name:"透传",value:"WITHOUT"},{name:"SQL转换",value:"SQL"},{name:"脚本转换",value:"SCRIPT",items:[{name:"JavaScript脚本",value:"SCRIPT-JAVASCRIPT"},{name:"Groovy脚本",value:"SCRIPT-GROOVY"}]},{name:"插件转换",value:"PLUGIN"}];function a(){for(var e={},t=0;t<r.length;t++)e[r[t].value]=r[t].name;return e}var o=a()}}]);